<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>🛠️ إزالة الشعار ورفع جودة الصور | من مهندس محمد حماد</title>

<!-- مكتبة الذكاء الصناعي لرفع الجودة -->
<script src="https://cdn.jsdelivr.net/npm/upscaler@1.0.0/dist/browser.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>

<style>
  :root { --brand:#00e0a4; --bg:#0f1115; --panel:#151923; --text:#e9eef3; }
  body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Arial}
  header{padding:20px;text-align:center;border-bottom:1px solid #222}
  h1{margin:0 0 8px 0;color:var(--brand);font-weight:700}
  main{max-width:1100px;margin:24px auto;padding:0 16px}
  .card{background:var(--panel);border:1px solid #222;border-radius:14px;padding:16px;margin-bottom:16px}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  label{font-size:14px;opacity:.9}
  input[type="file"]{display:block;width:100%;padding:22px;border:2px dashed var(--brand);border-radius:12px;background:#0c0f14;color:#9fb0c3;text-align:center;cursor:pointer}
  input[type="file"]::before{content:"📤 رفع الصور";display:block;font-size:16px;font-weight:bold;color:var(--brand);margin-bottom:6px}
  input[type="number"],input[type="range"],select{background:#0c0f14;color:var(--text);border:1px solid #2a2f3a;border-radius:10px;padding:8px}
  input[type="range"]{width:180px}
  .btn{background:var(--brand);color:#02130e;border:0;border-radius:10px;padding:10px 16px;font-weight:700;cursor:pointer}
  .btn[disabled]{opacity:.5;cursor:not-allowed}
  .muted{opacity:.8;font-size:13px}
  .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:12px}
  .thumb{background:#0c0f14;border:1px solid #2a2f3a;border-radius:12px;overflow:hidden;padding-bottom:10px}
  .thumb canvas{width:100%;display:block}
  .controls{padding:10px;background:#11171e;border-top:1px solid #2a2f3a;text-align:center}
  .controls label{font-size:12px;display:block;margin-bottom:4px}

  /* شريط التقدم */
  progress {
    width: 100%;
    height: 14px;
    border-radius: 10px;
    overflow: hidden;
    appearance: none;
    background: #222;
  }
  progress::-webkit-progress-bar {background-color:#222;border-radius:10px;}
  progress::-webkit-progress-value {
    background: linear-gradient(270deg, var(--brand), #00b8ff, var(--brand));
    background-size: 200% 100%;
    border-radius: 10px;
    animation: moveBar 2s linear infinite;
  }
  progress::-moz-progress-bar {
    background: linear-gradient(270deg, var(--brand), #00b8ff, var(--brand));
    background-size: 200% 100%;
    border-radius: 10px;
    animation: moveBar 2s linear infinite;
  }
  @keyframes moveBar {
    0% { background-position: 0% 0; }
    100% { background-position: -200% 0; }
  }

  /* الرسالة المتحركة أسفل الشريط */
  #aiStatus {
    text-align:center;
    margin-top:10px;
    font-size:15px;
    color:#00b8ff;
    font-weight:bold;
  }
  #aiStatus span {
    display:inline-block;
    animation: spin 1.2s linear infinite;
  }
  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  footer{opacity:.85;text-align:center;padding:24px 0;font-size:15px;color:#b4c7d4}
  footer a{color:var(--brand);text-decoration:none;font-weight:bold}
  #popup{position:fixed;inset:0;background:rgba(0,0,0,0.8);display:flex;align-items:center;justify-content:center;z-index:9999;visibility:hidden;opacity:0;transition:.3s;}
  #popup.active{visibility:visible;opacity:1;}
  #popup .box{background:#151923;padding:30px;border-radius:16px;text-align:center;max-width:400px;line-height:1.7;box-shadow:0 0 20px rgba(0,0,0,0.4);}
  #popup h2{color:var(--brand);margin-bottom:10px}
  #popup button{margin-top:15px}
  #activeUsers{margin-top:10px;font-size:18px;color:#00e0a4;font-weight:bold;}
  #soundToggle {
    position: fixed;bottom: 20px;left: 20px;
    background: var(--brand);color: #02130e;border: none;border-radius: 50%;
    width: 48px;height: 48px;font-size: 22px;font-weight: bold;
    cursor: pointer;box-shadow: 0 0 12px rgba(0,0,0,0.5);z-index: 999;
    transition: transform .2s ease;
  }
  #soundToggle:hover { transform: scale(1.1); }
</style>
</head>
<body>
<header>
  <h1>🛠️ إزالة الشعار ورفع جودة الصور | من مهندس محمد حماد</h1>
  <div class="muted">يمكنك رفع عدد 50 صورة معاً | من أجل عيوني متابعيني ❤️</div>
  <div id="activeUsers">يستخدم هذه الأداة الآن: <span id="userCount">0</span> مستخدم</div>
</header>

<main>
  <div class="card">
    <input id="picker" type="file" accept="image/*" multiple title="رفع الصور" />
    <div class="row" style="margin-top:12px">
      <div>
        <label>اتجاه القص العمودي:</label><br>
        <select id="vertSide">
          <option value="right">يمين</option>
          <option value="left">يسار</option>
        </select>
      </div>
      <div>
        <label>عرض القص العمودي: <span id="vertVal">2</span>%</label><br>
        <div class="row">
          <input id="vertCut" type="range" min="0" max="15" step="0.5" value="2">
          <input id="vertNum" type="number" min="0" max="15" step="0.5" value="2" style="width:70px">
        </div>
      </div>
      <div>
        <label>قص سفلي: <span id="bottomVal">0</span>%</label><br>
        <div class="row">
          <input id="bottomCut" type="range" min="0" max="20" step="0.5" value="0">
          <input id="bottomNum" type="number" min="0" max="20" step="0.5" value="0" style="width:70px">
        </div>
      </div>
      <div>
        <label>الهدف:</label><br>
        <select id="target">
          <option value="4k">4K (3840×2160)</option>
          <option value="uhd3840">أطول ضلع = 3840</option>
          <option value="none">بدون ترقية</option>
        </select>
      </div>
    </div>
  </div>

  <div class="card row">
    <button class="btn" id="btnProcess">🔄 تنفيذ على الكل</button>
    <button class="btn" id="btnDownload">⬇️ تنزيل الكل (صور منفصلة)</button>
    <button class="btn" id="btnZip">📦 تنزيل ملف مضغوط (ZIP)</button>
    <div class="muted">كل تغيير في المؤشرات يحدث المعاينة فورًا.</div>
  </div>

  <div class="card">
    <div class="row" style="align-items:center;gap:8px">
      <strong>التقدّم:</strong>
      <progress id="bar" max="100" value="0"></progress>
      <span id="status" class="muted">جاهز</span>
    </div>
    <div id="aiStatus"> </div>
  </div>

  <div class="card">
    <h3>📸 المعاينات</h3>
    <div id="preview" class="grid"></div>
  </div>
</main>

<footer>
  هذه الأداة من برمجة وملك <strong>المهندس محمد حماد</strong> – تابعوه على الفيسبوك:
  <br>👉 <a href="https://www.facebook.com/en.mohamed.nasr" target="_blank">facebook.com/en.mohamed.nasr</a>
</footer>

<audio id="bgMusic" src="https://mohamednasr5.github.io/logo/bg.mp3" loop autoplay></audio>
<button id="soundToggle">🔊</button>

<!-- نافذة القسم -->
<div id="popup">
  <div class="box">
    <h2>⚠️ قسم المستخدم</h2>
<p style="font-size:18px;line-height:1.8;text-align:center;color:#fff;">
قبل استخدام هذه الأداة، <strong>أُقْسِم بالله العظيم</strong>  
أن أتابع حساب المهندس <strong>محمد حماد</strong> على فيسبوك  
(<a href="https://www.facebook.com/en.mohamed.nasr" target="_blank" style="color:#00e0a4;">تابع من هنا</a>)  
وأشهد الله أني إن استخدمت الأداة دون متابعة، أو ألغيت المتابعة لاحقًا،  
فإني أكون قد أخلفت وعدي وخنت أمانتي وظلمت نفسي.  
</p>
    <p>✳️ رابط المتابعة: <br>
      <a href="https://www.facebook.com/en.mohamed.nasr" target="_blank" style="color:#00e0a4;font-weight:bold">متابعة المهندس محمد حماد الآن</a>
    </p>
    <label><input type="checkbox" id="agreeBox"> ✔ أقر وأقسم بذلك</label><br>
    <button class="btn" id="agreeBtn" disabled>أقسم وأقر بذلك ✅</button>
  </div>
</div>

<script>
(() => {
  const userCountEl=document.getElementById('userCount');
  let users=Math.floor(Math.random()*(6254-1052+1))+1052;
  userCountEl.textContent=users.toLocaleString('ar-EG');
  setInterval(()=>{const change=Math.floor(Math.random()*10)-5;
  users=Math.max(1052,Math.min(6254,users+change));
  userCountEl.textContent=users.toLocaleString('ar-EG');},3000);

  const bgMusic=document.getElementById('bgMusic');
  const soundBtn=document.getElementById('soundToggle');
  let isMuted=false; bgMusic.volume=0.3;
  document.addEventListener('click',()=>{if(bgMusic.paused&&!isMuted)bgMusic.play().catch(()=>{});},{once:true});
  soundBtn.addEventListener('click',()=>{if(isMuted){bgMusic.muted=false;bgMusic.play();soundBtn.textContent="🔊";}else{bgMusic.muted=true;soundBtn.textContent="🔇";}isMuted=!isMuted;});

  const picker=document.getElementById('picker');
  const vertCut=document.getElementById('vertCut'), bottomCut=document.getElementById('bottomCut');
  const vertNum=document.getElementById('vertNum'), bottomNum=document.getElementById('bottomNum');
  const vertVal=document.getElementById('vertVal'), bottomVal=document.getElementById('bottomVal');
  const vertSide=document.getElementById('vertSide'), targetSel=document.getElementById('target');
  const previewEl=document.getElementById('preview'), bar=document.getElementById('bar');
  const status=document.getElementById('status'), aiStatus=document.getElementById('aiStatus');
  const btnProcess=document.getElementById('btnProcess'), btnDownload=document.getElementById('btnDownload');
  const btnZip=document.getElementById('btnZip');

  let files=[],previews=[];
  function clamp(v,min,max){return Math.max(min,Math.min(max,v));}
  function syncRangeNum(range,num,label){
    const setBoth=val=>{val=clamp(val,parseFloat(range.min),parseFloat(range.max));
    range.value=num.value=val;label.textContent=val;updateGlobalPreviews();};
    range.addEventListener('input',()=>setBoth(parseFloat(range.value)));
    num.addEventListener('input',()=>setBoth(parseFloat(num.value)));
  }
  syncRangeNum(vertCut,vertNum,vertVal);
  syncRangeNum(bottomCut,bottomNum,bottomVal);
  [vertSide,targetSel].forEach(el=>el.addEventListener('change',updateGlobalPreviews));

  picker.addEventListener('change',async()=>{
    files=Array.from(picker.files); if(!files.length)return;
    previewEl.innerHTML='';previews=[];
    for(let i=0;i<files.length;i++){
      const img=await loadImage(files[i]);
      const c=await cropImage(img,getGlobalOptions());
      const div=createPreview(c,files[i].name,i);
      previewEl.appendChild(div);
      previews.push({img,c,div});
    }
  });

  function loadImage(file){return new Promise((res,rej)=>{const img=new Image();img.onload=()=>res(img);img.onerror=rej;img.src=URL.createObjectURL(file);});}
  function getGlobalOptions(){return{verticalPercent:parseFloat(vertNum.value),bottomPercent:parseFloat(bottomNum.value),side:vertSide.value,target:targetSel.value};}

  async function cropImage(img,opt){
    const {verticalPercent,bottomPercent,side,target}=opt;
    const vpx=verticalPercent/100,bpx=bottomPercent/100;
    const sx=side==='left'?img.width*vpx:0;
    const sw=img.width*(1-vpx),sh=img.height*(1-bpx);
    const c=document.createElement('canvas');
    c.width=sw;c.height=sh;
    const ctx=c.getContext('2d');
    ctx.imageSmoothingQuality='high';
    ctx.drawImage(img,sx,0,sw,sh,0,0,sw,sh);

    if(target!=='none'){
      aiStatus.innerHTML='<span>🔄</span> جارٍ رفع الجودة بالذكاء الصناعي...';
      const upscaler=new window.Upscaler({model:'real-esrgan',scale:4});
      const upscaled=await upscaler.upscale(c);
      aiStatus.innerHTML='✅ تم رفع الجودة بنجاح!';
      const upgradedCanvas=document.createElement('canvas');
      const ctx2=upgradedCanvas.getContext('2d');
      if(target==='4k'){upgradedCanvas.width=3840;upgradedCanvas.height=2160;}
      else if(target==='uhd3840'){const ratio=Math.max(3840/upscaled.width,3840/upscaled.height);upgradedCanvas.width=upscaled.width*ratio;upgradedCanvas.height=upscaled.height*ratio;}
      else{upgradedCanvas.width=upscaled.width;upgradedCanvas.height=upscaled.height;}
      ctx2.imageSmoothingQuality='high';ctx2.drawImage(upscaled,0,0,upgradedCanvas.width,upgradedCanvas.height);
      return upgradedCanvas;
    }
    return c;
  }

  function drawToCanvas(cv,src){const ctx=cv.getContext('2d');const scale=Math.min(1,260/src.width);
    cv.width=src.width*scale;cv.height=src.height*scale;ctx.clearRect(0,0,cv.width,cv.height);ctx.drawImage(src,0,0,cv.width,cv.height);}
})();
</script>
</body>
</html>
